; Task 4 - Converting a binary multibyte natural number to an integer
;

DSEG	AT	30h
BIN_VAL:	DS	4
A_VAL:		DS	4
B_VAL:		DS	4
R_VAL:		DS	4
BCD_VAL:	DS	5

CSEG	AT	0

RESET:
	AJMP	MAIN
;--------------------------------	
;Here goes your solution
BIN2BCD:
    MOV		A, @R0
	MOV		B, #10
	DIV		AB
	MOV		@R1, B
	
	MOV		B, #10
	DIV		AB
	
	MOV		R7, A  ; store first digit
	
	MOV		A, B   ; move second digit to A
	RL		A      ; shift second digit by 4 bits
	RL		A
	RL		A
	RL		A
	ORL		A, @R1 ; append both digits
	MOV		@R1, A ; save
	
	INC		R1     ; move by 1 and repeat all
	
	MOV		A, R7
		MOV		B, #10
	DIV		AB
	MOV		@R1, B
	
	MOV		B, #10
	DIV		AB
	
	MOV		R7, A
	
	MOV		A, B
	RL		A
	RL		A
	RL		A
	RL		A
	ORL		A, @R1
	MOV		@R1, A
	
	INC		R1
	
	
	
	;RET
	LJMP TEST_STEP
	

DIVIDE:
	
	
	
	
;--------------------------------

MAIN:
	MOV		SP,#7Fh	
	MOV		DPTR,#TEST_DATA
TEST_LP:	
	MOV		R7,#4
	MOV		R0,#BIN_VAL
LD_LP:
	CLR		A
	MOVC	A,@A+DPTR
	MOV		@R0, A
	INC		DPTR
	INC		R0
	DJNZ	R7, LD_LP
	CLR		A
	MOVC	A,@A+DPTR	
	JZ		STOP
	INC		DPTR
	MOV		R0,#BIN_VAL
	MOV		R1,#BCD_VAL	
	;ACALL	BIN2BCD
	LJMP BIN2BCD
TEST_STEP:	
	SJMP	TEST_LP
	
STOP:
	SJMP	STOP
	
	
TEST_DATA:
	DB 0x01, 0x00, 0x00, 0x00,  0x01
	DB 0x02, 0x00, 0x00, 0x00,  0x01
	DB 0x04, 0x00, 0x00, 0x00,  0x01
	DB 0x08, 0x00, 0x00, 0x00,  0x01
	DB 0x10, 0x00, 0x00, 0x00,  0x01
	DB 0x20, 0x00, 0x00, 0x00,  0x01
	DB 0x40, 0x00, 0x00, 0x00,  0x01
	DB 0x80, 0x00, 0x00, 0x00,  0x01
	DB 0x00, 0x01, 0x00, 0x00,  0x01
	DB 0x00, 0x02, 0x00, 0x00,  0x01
	DB 0x00, 0x04, 0x00, 0x00,  0x01
	DB 0x00, 0x08, 0x00, 0x00,  0x01
	DB 0x00, 0x10, 0x00, 0x00,  0x01
	DB 0x00, 0x20, 0x00, 0x00,  0x01
	DB 0x00, 0x40, 0x00, 0x00,  0x01
	DB 0x00, 0x80, 0x00, 0x00,  0x01
	DB 0x00, 0x00, 0x01, 0x00,  0x01
	DB 0x00, 0x00, 0x02, 0x00,  0x01
	DB 0x00, 0x00, 0x04, 0x00,  0x01
	DB 0x00, 0x00, 0x08, 0x00,  0x01
	DB 0x00, 0x00, 0x10, 0x00,  0x01
	DB 0x00, 0x00, 0x20, 0x00,  0x01
	DB 0x00, 0x00, 0x40, 0x00,  0x01
	DB 0x00, 0x00, 0x80, 0x00,  0x01
	DB 0x00, 0x00, 0x00, 0x01,  0x01
	DB 0x00, 0x00, 0x00, 0x02,  0x01
	DB 0x00, 0x00, 0x00, 0x04,  0x01
	DB 0x00, 0x00, 0x00, 0x08,  0x01
	DB 0x00, 0x00, 0x00, 0x10,  0x01
	DB 0x00, 0x00, 0x00, 0x20,  0x01
	DB 0x00, 0x00, 0x00, 0x40,  0x01
	DB 0x45, 0x00, 0x00, 0x00,  0x01
	DB 0x5A, 0x00, 0x00, 0x00,  0x01
	DB 0x4A, 0x00, 0x00, 0x00,  0x01
	DB 0x31, 0x00, 0x00, 0x00,  0x01
	DB 0x5E, 0xB3, 0x00, 0x00,  0x01
	DB 0xFC, 0x77, 0x00, 0x00,  0x01
	DB 0x56, 0x77, 0x00, 0x00,  0x01
	DB 0x11, 0xF2, 0x00, 0x00,  0x01
	DB 0xE6, 0x46, 0xAC, 0x00,  0x01
	DB 0xB8, 0x2B, 0x32, 0x00,  0x01
	DB 0x6D, 0x3B, 0x93, 0x00,  0x01
	DB 0xF9, 0x3D, 0xB0, 0x00,  0x01
	DB 0x54, 0xD4, 0x3D, 0x37,  0x01
	DB 0x3C, 0x38, 0x8F, 0x49,  0x01
	DB 0x0B, 0x2A, 0xB0, 0x6C,  0x01
	DB 0xEA, 0x82, 0x4E, 0x1F,  0x00
	
	END
	
